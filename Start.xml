<?xml version="1.0" encoding="utf-8"?>
<!--
Start Profile
At least 1 Combat class level 60+ or in post Heavensward with a Gear Set
-->
<Profile>
	<Name>Start Profile</Name>
	<BehaviorDirectory>../Quest Behaviors</BehaviorDirectory>		
	<Order>	
	
	<!-- Check to see if we have unlock all Crafting Profiles -->
	
			<If Condition="not (IsQuestCompleted(65807) and IsQuestCompleted(65809) 
							and IsQuestCompleted(65827) and IsQuestCompleted(65674) 
							and IsQuestCompleted(65641) and IsQuestCompleted(65539) 
							and IsQuestCompleted(66144) and IsQuestCompleted(66070) 
							and IsQuestCompleted(66111) and IsQuestCompleted(66133))">
				<LogMessage Message="Going to learn Classes!" />
				<RunCode Name="classes"/>
				<LoadProfile Path="UnlockDoHDoLClasses.xml"/>	
			</If>
			
			
			
		
	<!-- Check to see if we have Gathering at level 21 -->			
						
			<If Condition="not IsQuestCompleted(66139) or Core.Me.Levels[ClassJobType.Miner] &lt; 30">
				<LoadProfile Path="Gathering/1-21 Miner.xml"/>
			</If>
			<If Condition="not IsQuestCompleted(65542) or Core.Me.Levels[ClassJobType.Botanist] &lt; 20">
				<LoadProfile Path="Gathering/1-21 Botanist.xml"/>
			</If>
			
	
	
	
	<!-- Check to see if we have Crafting at level 21 -->	
			
			<If Condition="Core.Me.Levels[ClassJobType.Carpenter] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Carpenter.xml"/>
			</If>			
			<If Condition="Core.Me.Levels[ClassJobType.Blacksmith] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Blacksmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Armorer] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Armorer.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Goldsmith] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Goldsmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Leatherworker] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Leatherworker.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Weaver] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Weaver.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Alchemist] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Alchemist.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Culinarian] &lt; 21">	
				<LoadProfile Path="Crafting/1-21 Culinarian.xml"/>
			</If>		
			
					
	
		
		<!-- Craft Gathering and Crafting Gear 21 -->
		
		
		
		
		<!-- Unlock Ishgard -->
		
			<!-- <If Condition="not IsQuestCompleted(67783)"> --> <!-- Check to See if Litany of Peace is completed. -->
				<!-- <RunCode Name="Profile2"/>	
			</If>	
			<If Condition="IsQuestCompleted(67783) and not IsQuestCompleted(69208)">
				<LoadProfile Path="Unlock Ishgard Firmament.xml"/>
			</If> -->
				
		
		
		
		<!-- 21-51 Ishgard Crafting -->
		
		<If Condition="IsQuestCompleted(69208)">
			<If Condition="Core.Me.Levels[ClassJobType.Carpenter] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Carpenter.xml"/>
			</If>			
			<If Condition="Core.Me.Levels[ClassJobType.Blacksmith] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Blacksmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Armorer] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Armorer.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Goldsmith] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Goldsmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Leatherworker] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Leatherworker.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Weaver] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Weaver.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Alchemist] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Alchemist.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Culinarian] &lt; 51">	
				<LoadProfile Path="Crafting/21-51 Culinarian.xml"/>
			</If>
		</If>
		
		
		
		
		<!-- Gatherer's to 40 -->
		
		<If Condition="not IsQuestCompleted(66179) or Core.Me.Levels[ClassJobType.Miner] &lt; 40">
				<LoadProfile Path="Gathering/21-40 Miner.xml"/>
		</If>
		<If Condition="not IsQuestCompleted(65546) or Core.Me.Levels[ClassJobType.Botanist] &lt; 40">
			<LoadProfile Path="Gathering/21-40 Botanist.xml"/>
		</If>
			
		
		
		
		<!-- Craft Level 40 Gathering Gear -->
		
		
		
		<!-- Gatherer's to 51 -->
		
		<If Condition="not IsQuestCompleted(66182) or Core.Me.Levels[ClassJobType.Miner] &lt; 51">
			<LoadProfile Path="Gathering/40-51 Miner.xml"/>
		</If>
		<If Condition="not IsQuestCompleted(65549) or Core.Me.Levels[ClassJobType.Botanist] &lt; 51">
			<LoadProfile Path="Gathering/40-51 Botanist.xml"/>
		</If>
			
				
		
		
		<!-- Craft Gathering and Crafting Gear 51 -->
		
		
		
		<!-- 51-63 Ishgard Crafting -->
		
		<If Condition="IsQuestCompleted(69208)">
			<If Condition="Core.Me.Levels[ClassJobType.Carpenter] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Carpenter.xml"/>
			</If>			
			<If Condition="Core.Me.Levels[ClassJobType.Blacksmith] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Blacksmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Armorer] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Armorer.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Goldsmith] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Goldsmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Leatherworker] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Leatherworker.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Weaver] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Weaver.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Alchemist] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Alchemist.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Culinarian] &lt; 63">	
				<LoadProfile Path="Crafting/51-63 Culinarian.xml"/>
			</If>
		</If>
		
		
		
		
		<!-- Heavensward Aether Currents -->
		
		<!--<If Condition=""> Systematic Exploration??? 67200 
			<LoadProfile Path="Aether Currents/Heavensward Aether Currents All.xml"/>
		</If>-->
		
		
		
		
		<!-- Craft 53 BTN/MIN MH & OH -->
		
		
		
		<!-- Gatherer's to 63 -->
		
		<If Condition="not IsQuestCompleted(68090) or Core.Me.Levels[ClassJobType.Miner] &lt; 63">
			<LoadProfile Path="Gathering/51-63 Miner.xml"/>
		</If>
		<If Condition="not IsQuestCompleted(68156) or Core.Me.Levels[ClassJobType.Botanist] &lt; 63">
			<LoadProfile Path="Gathering/51-63 Botanist.xml"/>
		</If>
		
		
		
		
		<!-- Craft Gathering and Crafting Gear 63 -->
		
		
		
		<!-- Do DoH Quests -->	
		
		
		<!-- 63-70 Ishgard Crafting -->
		
		<If Condition="IsQuestCompleted(69208)">
			<If Condition="Core.Me.Levels[ClassJobType.Carpenter] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Carpenter.xml"/>
			</If>			
			<If Condition="Core.Me.Levels[ClassJobType.Blacksmith] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Blacksmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Armorer] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Armorer.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Goldsmith] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Goldsmith.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Leatherworker] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Leatherworker.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Weaver] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Weaver.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Alchemist] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Alchemist.xml"/>
			</If>
			<If Condition="Core.Me.Levels[ClassJobType.Culinarian] &lt; 70">	
				<LoadProfile Path="Crafting/63-70 Culinarian.xml"/>
			</If>
		</If>
		
		
		
		
		<!-- Stormblood Aether Currents -->
		
		<!--<If Condition="">  Stormblood(Quest)????? 68089
			<LoadProfile Path="Aether Currents/Stormblood Aether Currents All.xml"/>
		</If>-->
		
		
		
		
		<!-- Farm Gatherer's Yellow Scrip Level 70 Set --> 
		
		
		
		<!-- Farm Crafter's Yellow Scrip Level 70 Set -->
		
		
		
		<!-- Gatherer's to 70 -->		
		
		<If Condition="not IsQuestCompleted(68094) or Core.Me.Levels[ClassJobType.Miner] &lt; 70">
			<LoadProfile Path="Gathering/51-63 Miner.xml"/>
		</If>
		<If Condition="not IsQuestCompleted(68160) or Core.Me.Levels[ClassJobType.Botanist] &lt; 70">
			<LoadProfile Path="Gathering/51-63 Botanist.xml"/>
		</If>
		
		
		<!-- 70-80 Ishgard Crafting -->
		
		
		
		<!-- Gatherer's to 80 -->	
	
	
			
	
	
	
	
	
	<RunCode Name="finish"/>
	
	
	
	
	
	
	
	
	</Order>
	<CodeChunks>
		<CodeChunk Name="AutoEquip">
        <![CDATA[ 
            var patternFinder = new GreyMagic.PatternFinder(Core.Memory);
            IntPtr agentVtable = patternFinder.Find("48 8D 05 ? ? ? ? C6 43 ? ? 48 89 03 48 8B C3 C7 43 ? ? ? ? ? Add 3 TraceRelative");
            int id = AgentModule.FindAgentIdByVtable(agentVtable);

            AtkAddonControl windowByName = RaptureAtkUnitManager.GetWindowByName("RecommendEquip");

            if (windowByName == null)
            {
                AgentModule.GetAgentInterfaceById(id).Toggle();
            }

            await Coroutine.Wait(10000, () => RaptureAtkUnitManager.GetWindowByName("RecommendEquip") != null);
            
            windowByName = RaptureAtkUnitManager.GetWindowByName("RecommendEquip");
            
            if (windowByName != null)
            {
                windowByName.SendAction(1, 3, 0);
            }
        ]]>
        </CodeChunk>
		<CodeChunk Name="UpdateGearSet">
		<![CDATA[ 
		   var patternFinder = new GreyMagic.PatternFinder(Core.Memory);
            IntPtr agentCharVtable = patternFinder.Find("48 8D 05 ? ? ? ? 89 77 ? Add 3 TraceRelative");
			int idChar = AgentModule.FindAgentIdByVtable(agentCharVtable);

			AtkAddonControl windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

			if (windowByName == null)
			{
				AgentModule.GetAgentInterfaceById(idChar).Toggle();
			}

			await Coroutine.Wait(5000, () => RaptureAtkUnitManager.GetWindowByName("Character") != null);

			windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

			if (windowByName != null)
			{
				windowByName.SendAction(1, 3, 0xF);
			}
            
            await Coroutine.Wait(1000, () => SelectYesno.IsOpen);

            if (SelectYesno.IsOpen)
                SelectYesno.Yes();

			await Coroutine.Wait(1000, () => !SelectYesno.IsOpen);
			
            await Coroutine.Sleep(200);
			
			windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

			if (windowByName != null)
			{
				AgentModule.GetAgentInterfaceById(idChar).Toggle();
			}
			
		]]>
		</CodeChunk>
		<CodeChunk Name="finish">
		<![CDATA[
			Core.OverlayManager.AddToast(() => "Congrats on level 21 on BTN/MIN and all Crafters.\n More to come! :)", TimeSpan.FromMilliseconds(25000), System.Windows.Media.Color.FromRgb(29,213,226), System.Windows.Media.Color.FromRgb(13,106,175), new System.Windows.Media.FontFamily("Gautami"));
			await Coroutine.Sleep(40000);
		]]>
		</CodeChunk>
		<CodeChunk Name="classes">
		<![CDATA[
			Core.OverlayManager.AddToast(() => "Going to learn Doh/DoL classes, this profile will stop when completed!", TimeSpan.FromMilliseconds(25000), System.Windows.Media.Color.FromRgb(29,213,226), System.Windows.Media.Color.FromRgb(13,106,175), new System.Windows.Media.FontFamily("Gautami"));
			await Coroutine.Sleep(20000);
		]]>
		</CodeChunk>
		<CodeChunk Name="Profile2">
		<![CDATA[ 
			Core.OverlayManager.AddToast(() => "You have not completed the quest Litany of Peace HW Patch 3.3.\n Please run through Heavensward MSQ to complete the quest!", TimeSpan.FromMilliseconds(25000), System.Windows.Media.Color.FromRgb(29,213,226), System.Windows.Media.Color.FromRgb(13,106,175), new System.Windows.Media.FontFamily("Gautami"));
			await Coroutine.Sleep(25000);
		]]>
		</CodeChunk>
	</CodeChunks>
</Profile>