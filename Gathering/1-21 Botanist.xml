<?xml version="1.0" encoding="utf-8"?>
<!--
Angles24
-->
<Profile>
	<Name>1-21 Botanist</Name>
	<BehaviorDirectory>..\Quest Behaviors</BehaviorDirectory>
	<KillRadius>90</KillRadius>
	
	<Order>
		
	<LogMessage Message="The Journey Begins! Remember to Check up on me!" />		
			
	<If Condition="ClassName != ClassJobType.Botanist">
		<ChangeClass Job="Botanist" />
	</If> 
				
    <If Condition="ClassName == ClassJobType.Botanist">
		<If Condition="Core.Player.ClassLevel &lt; 20">		
		<RunCode Name="AutoEquip"/>
		<RunCode Name="UpdateGearSet"/>
		<RunCode Name="Triangulate" />
				
		<WaitWhile Condition="Managers.QuestLogManager.InCutscene" />

		<!--Level 1 - My First Hatchet-->
		<If Condition="not IsQuestCompleted(65744)">
			<If Condition="not HasQuest(65744)">
				<LogMessage Message="Picking up Level 1 - My First Hatchet." />
				<If Condition="not IsOnMap(133)">
					<TeleportTo Name="New Gridania" AetheryteId="2" />
				</If>
				<If Condition="IsOnMap(132)">
					<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
				</If>
				<If Condition="IsOnMap(133)">
					<MoveTo Name="Fufucha" Distance="1" UseMesh="True" XYZ="-232.9017, 6.263501, -169.7613" />
					<If Condition="IsQuestAcceptQualified(65744)">
						<PickupQuest NpcId="1000815" QuestId="65744" XYZ="-232.9017, 6.263501, -169.7613" />
					</If>
				</If>
			</If>
			<If Condition="not NqHasAtLeast(5509,10)">
				<If Condition="not IsOnMap(154)">
					<GetTo ZoneId="154" XYZ="404.9244, -6.997395, 234.0985" />
					<!--<MoveTo Name="North Shroud" Distance="0" XYZ="-209.6565, 10.36851, -98.76298" />-->
				</If>
				<Gather while="not NqHasAtLeast(5509,10)">
					<GatherObject>Mature Tree</GatherObject>
					<HotSpots>
						<HotSpot Radius="90" XYZ="404.9244, -6.997395, 234.0985" />
					</HotSpots>
					<BlackSpots>
						<BlackSpot Radius="10" XYZ="375.1317, 1.328892, 186.7884" />
						<BlackSpot Radius="10" XYZ="360.7055, -0.2182511, 183.7374" />
					</BlackSpots>
					<Slot>3</Slot>
				</Gather>
			</If>
			<If Condition="NqHasAtLeast(5509,10)">
				<If Condition="GetQuestStep(65744) == 255">
					<If Condition="IsOnMap(154)">
						<MoveTo Name="Old Gridania2" Distance="0" XYZ="457.1599, -1.377329, 197.6014" />
					</If>
					<If Condition="IsOnMap(133)">
						<LLTurnIn ItemId="5509" QuestId="65744" StepId="255" NpcId="1000815" InteractDistance="2.0" XYZ="-232.9017, 6.263501, -169.7613" />
						<LogMessage Message="Level 1 - My First Hatchet - Completed." />						
						<RunCode Name="AutoEquip"/>	
						<RunCode Name="UpdateGearSet"/>
					</If>
				</If>
			</If>
		</If>
		<!--End Level 1-->

		<!--Start - Grind to Level 6-->
		<If Condition="Core.Player.ClassLevel &lt; 6">
			<LogMessage Message="Starting the Grind to Level 6." />
			<If Condition="not IsOnMap(148)">
				<GetTo ZoneId="148" XYZ="5.736485, -1.221331, 36.01854" /> <!-- Bentbranch Meadows -->
			</If>
			<Gather while="Core.Player.ClassLevel &lt; 6">
				<GatherObject>Mature Tree</GatherObject>
				<HotSpots>
					<HotSpot Radius="95" XYZ="61.03972, 4.745368, -179.8398" />
				</HotSpots>
				<Slot>3</Slot>
			</Gather>
		</If>
		<If Condition="Core.Player.ClassLevel == 6">
			<LogMessage Message="Congrats on Level 6, moving on." />			
			<RunCode Name="AutoEquip"/>	
			<RunCode Name="UpdateGearSet"/>							
		</If>
		<!--End Level 6 Grind-->

		<!--Level 5 - Sap for Smiles-->
		<If Condition="not IsQuestCompleted(65540)">
			<If Condition="not HasQuest(65540)">
				<LogMessage Message="Picking up Level 5 - Sap for Smiles." />
				<If Condition="not IsOnMap(133)">
					<TeleportTo Name="New Gridania" AetheryteId="2" />
				</If>
				<If Condition="IsOnMap(132)">
					<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
				</If>
				<If Condition="IsOnMap(133)">
					<MoveTo Name="Fufucha" Distance="1" UseMesh="True" XYZ="-232.9017, 6.263501, -169.7613" />
					<If Condition="IsQuestAcceptQualified(65540)">
						<PickupQuest NpcId="1000815" QuestId="65540" XYZ="-232.9017, 6.263501, -169.7613" />
					</If>
				</If>
			</If>
			<If Condition="not NqHasAtLeast(5498,50)">
				<If Condition="not IsOnMap(154)">
					<MoveTo Name="North Shroud" Distance="0" XYZ="-209.6565, 10.36851, -98.76298" />
				</If>
				<Gather while="not NqHasAtLeast(5498,50)">
					<GatherObject>Mature Tree</GatherObject>
					<HotSpots>
						<HotSpot Radius="90" XYZ="260.8503, -17.60432, 305.0657" />
					</HotSpots>
					<Slot>3</Slot>
					<GatheringSkillOrder>
						<GatheringSkill SpellName="Field Mastery II" TimesToCast="1" />
					</GatheringSkillOrder>
				</Gather>
			</If>
			<If Condition="NqHasAtLeast(5498,50)">
				<If Condition="GetQuestStep(65540) == 255">
					<If Condition="IsOnMap(154)">
						<MoveTo Name="Old Gridania2" Distance="0" XYZ="457.1599, -1.377329, 197.6014" />
					</If>
					<If Condition="IsOnMap(133)">
						<LLTurnIn ItemId="5498" QuestId="65540" StepId="255" NpcId="1000295" InteractDistance="2.0" XYZ="-236.451, 8.000312, -155.7238" />
						<LogMessage Message="Level 5 - Sap for Smiles - Completed." />						
						<RunCode Name="AutoEquip"/>	
						<RunCode Name="UpdateGearSet"/>							
					</If>
				</If>
			</If>
		</If>
		<!--End Level 5-->

		<!--Start Grind to Level 11-->
		<If Condition="Core.Player.ClassLevel &lt; 11">
			<LogMessage Message="Starting the Grind to Level 11" />
			<If Condition="not IsOnMap(148)">
				<GetTo ZoneId="148" XYZ="5.736485, -1.221331, 36.01854" /> <!-- Bentbranch Meadows -->
			</If>
			<Gather while="Core.Player.ClassLevel &lt; 11">
				<GatherObject>Mature Tree</GatherObject>
				<HotSpots>
					<HotSpot Radius="95" XYZ="243.2079, -12.19825, -55.7188" />
				</HotSpots>
				<Slot>7</Slot>
				<GatheringSkillOrder>
					<GatheringSkill SpellName="Field Mastery" TimesToCast="1" />
				</GatheringSkillOrder>
			</Gather>
		</If>
		<If Condition="Core.Player.ClassLevel == 11">
			<LogMessage Message="Congrats on Level 11, moving on." />			
			<RunCode Name="AutoEquip"/>	
			<RunCode Name="UpdateGearSet"/>							
		</If>
		<!--End Level 11 Grind-->

		<!--Level 10 - Weapons of a Feather-->
		<If Condition="not IsQuestCompleted(65541)">
			<If Condition="not HasQuest(65541)">
				<LogMessage Message="Picking up Level 10 - Weapons of a Feather." />
				<If Condition="not IsOnMap(133)">
					<TeleportTo Name="New Gridania" AetheryteId="2" />
				</If>
				<If Condition="IsOnMap(132)">
					<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
				</If>
				<If Condition="IsOnMap(133)">
					<MoveTo Name="Fufucha" Distance="1" UseMesh="True" XYZ="-232.9017, 6.263501, -169.7613" />
					<If Condition="IsQuestAcceptQualified(65541)">
						<PickupQuest NpcId="1000815" QuestId="65541" XYZ="-232.9017, 6.263501, -169.7613" />
					</If>
				</If>
			</If>
			<If Condition="not NqHasAtLeast(5352,99)">
				<If Condition="not IsOnMap(148)">
					<TeleportTo Name="Bentbranch Meadows" AetheryteId="3" />
				</If>
				<Gather while="not NqHasAtLeast(5352,99)">
					<GatherObject>Mature Tree</GatherObject>
					<HotSpots>
						<HotSpot Radius="90" XYZ="223.9362, -10.66788, -36.2442" />
					</HotSpots>
					<Slot>0</Slot>
					<GatheringSkillOrder>
						<GatheringSkill SpellName="Field Mastery III" TimesToCast="1" />
					</GatheringSkillOrder>
				</Gather>
			</If>
			<If Condition="NqHasAtLeast(5352,99)">
				<If Condition="GetQuestStep(65541) == 255">
					<If Condition="not IsOnMap(133)">
						<TeleportTo Name="New Gridania" AetheryteId="2" />
					</If>
					<If Condition="IsOnMap(132)">
						<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
					</If>
					<If Condition="IsOnMap(133)">
						<LLTurnIn ItemId="5352" QuestId="65541" StepId="255" NpcId="1000295" InteractDistance="2.0" XYZ="-236.451, 8.000312, -155.7238" />
						<LogMessage Message="Level 10 - Weapons of a Feather - Completed." />						
						<RunCode Name="AutoEquip"/>	
						<RunCode Name="UpdateGearSet"/>							
					</If>
				</If>
			</If>
		</If>
		<!--End Level 10-->

		<!--Start Grind to Level 16-->
		<If Condition="Core.Player.ClassLevel &lt; 16">
			<LogMessage Message="Starting the Grind to Level 16." />
			<If Condition="not IsOnMap(148)">
				<GetTo ZoneId="148" XYZ="5.736485, -1.221331, 36.01854" /> <!-- Bentbranch Meadows -->
			</If>
			<Gather while="Core.Player.ClassLevel &lt; 16">
				<GatherObject>Lush Vegetation Patch</GatherObject>
				<HotSpots>
					<HotSpot Radius="95" XYZ="40.93684, -8.794018, 114.2742" />
				</HotSpots>
				<Slot>3</Slot>
				<GatheringSkillOrder>
					<GatheringSkill SpellName="Field Mastery" TimesToCast="1" />
				</GatheringSkillOrder>
			</Gather>
		</If>
		<If Condition="Core.Player.ClassLevel == 16">
			<LogMessage Message="Congrats on Level 16, moving on." />			
			<RunCode Name="AutoEquip"/>	
			<RunCode Name="UpdateGearSet"/>							
		</If>
		<!--End Level 16 Grind-->

		<!--Level 15 - Haste Makes Waste-->
		<If Condition="not IsQuestCompleted(65542)">
			<If Condition="not HasQuest(65542)">
				<LogMessage Message="Picking up Level 15 - Haste Makes Waste." />
				<If Condition="not IsOnMap(133)">
					<TeleportTo Name="New Gridania" AetheryteId="2" />
				</If>
				<If Condition="IsOnMap(132)">
					<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
				</If>
				<If Condition="IsOnMap(133)">
					<MoveTo Name="Fufucha" Distance="1" UseMesh="True" XYZ="-232.9017, 6.263501, -169.7613" />
					<If Condition="IsQuestAcceptQualified(65542)">
						<PickupQuest NpcId="1000815" QuestId="65542" XYZ="-232.9017, 6.263501, -169.7613" />
					</If>
				</If>
			</If>
			<If Condition="GetQuestStep(65542) == 1">
				<TalkTo InteractDistance="3.0" NpcId="1000239" XYZ="167.8746, 15.69992, -117.8252" />
			</If>
			<If Condition="GetQuestStep(65542) == 2">
				<If Condition="not HqHasAtLeast(4832,10)">
					<If Condition="not IsOnMap(148)">
						<TeleportTo Name="Bentbranch Meadows" AetheryteId="3" />
					</If>
					<MoveTo Name="Quest Loc1" Distance="1" UseMesh="True" InteractDistance="1.0" XYZ="-142.1235, 1.872276, -118.8488" />
					<RunCode Name="Dismount" />
					
					<RunCode Name="Stealth" />
					
					<RunCode Name="DisableMount" />
					<Gather while="not HqHasAtLeast(4832,10)">
						<GatherObject>Lush Vegetation Patch</GatherObject>
						<HotSpots>
							<Hotspot Radius="90" XYZ="-142.1235, 1.872276, -118.8488" />
						</HotSpots>
						<Slot>5</Slot>
						<GatheringSkillOrder>
							<GatheringSkill SpellName="Leaf Turn" TimesToCast="1" />
						</GatheringSkillOrder>
					</Gather>
					<RunCode Name="EnableMount" />
				</If>
			</If>
			<If Condition="HqHasAtLeast(4832,10)">
				<If Condition="not IsOnMap(133)">
					<TeleportTo Name="New Gridania" AetheryteId="2" />
				</If>
				<If Condition="IsOnMap(132)">
					<MoveTo Name="Old Gridania" Distance="0" XYZ="13.86192, 1.113221, -16.00772" />
				</If>
				<If Condition="IsOnMap(133)">
					<If Condition="GetQuestStep(65542) == 2">
						<LLTurnIn ItemId="4832" RequiresHq="true" QuestId="65542" StepId="2" NpcId="1000239" InteractDistance="2.0" XYZ="167.8746, 15.69992, -117.8252" />
					</If>
					<If Condition="GetQuestStep(65542) == 255">
						<LLTurnIn QuestId="65542" StepId="255" NpcId="1000815" InteractDistance="2.0" XYZ="-232.9017, 6.263501, -169.7613" />
						<LogMessage Message="Level 15 - Haste Makes Waste - Completed." />						
						<RunCode Name="AutoEquip"/>	
						<RunCode Name="UpdateGearSet"/>						
					</If>
				</If>
			</If>
		</If>
		<!--End Level 15-->

		<!--Start Grind to Level 21-->
		<If Condition="Core.Player.ClassLevel &lt; 21">
			<LogMessage Message="Starting the Grind to Level 21." />
			<If Condition="not IsOnMap(152)">
				<GetTo ZoneId="152" XYZ="-192.3292, 3.769932, 291.1943" /> <!-- The Hawthorne Hut -->
			</If>
			<Gather while="Core.Player.ClassLevel &lt; 21">
				<GatherObject>Lush Vegetation Patch</GatherObject>
				<HotSpots>
					<HotSpot Radius="95" XYZ="-146.5669, 0.174731, 343.7414" />
				</HotSpots>
				<Slot>5</Slot>
				<GatheringSkillOrder>
					<GatheringSkill SpellName="Field Mastery II" TimesToCast="1" />
				</GatheringSkillOrder>
			</Gather>
		</If>
		<If Condition="Core.Player.ClassLevel &gt; 20">
			<LogMessage Message="Congrats on Level 21, moving on." />
			<RunCode Name="AutoEquip"/>	
			<RunCode Name="UpdateGearSet"/>							
		</If>
		<!--End Level 21 Grind-->		
	</If>
	</If>
	
	<LoadProfile Path="../Start.xml"/>
	
	</Order>
	<GrindAreas>
	</GrindAreas>
	<CodeChunks>		
		<CodeChunk Name="BTNWeapon">
			<![CDATA[
				var item = InventoryManager.FilledInventoryAndArmory.FirstOrDefault(i => i.Item.EquipmentCatagory == ItemUiCategory.Botanists_Primary_Tool);
				BagSlot EquipSlot = InventoryManager.GetBagByInventoryBagId(InventoryBagId.EquippedItems)[EquipmentSlot.MainHand];
				if (item != null)
				{
					item.Move(EquipSlot);
				}
		]]>
		</CodeChunk>
		<CodeChunk Name="BTNWeapon2">
			<![CDATA[
				var item = InventoryManager.FilledInventoryAndArmory.FirstOrDefault(i => i.Item.EquipmentCatagory == ItemUiCategory.Botanists_Secondary_Tool);
				BagSlot EquipSlot = InventoryManager.GetBagByInventoryBagId(InventoryBagId.EquippedItems)[EquipmentSlot.OffHand];
				if (item != null)
				{
					item.Move(EquipSlot);
				}
		]]>
		</CodeChunk>
		<CodeChunk Name="DisableMount">
			<![CDATA[
				ff14bot.Settings.CharacterSettings.Instance.UseMount = false;
		]]>
		</CodeChunk>
		<CodeChunk Name="Dismount">
			<![CDATA[
				ff14bot.Managers.ActionManager.Dismount();
		]]>
		</CodeChunk>
		<CodeChunk Name="EnableMount">
			<![CDATA[
				ff14bot.Settings.CharacterSettings.Instance.UseMount = true;
		]]>
		</CodeChunk>
		<CodeChunk Name="Stealth">
			<![CDATA[ if(!Core.Player.HasAura(47)) { ff14bot.Managers.ActionManager.DoAction("Stealth",Core.Player); await Coroutine.Wait(5000, () => Core.Player.HasAura(47)); } ]]>
		</CodeChunk>
		<CodeChunk Name="Triangulate">
			<![CDATA[ SpellData data;
				if (!Core.Me.HasAura(217) && ActionManager.CurrentActions.TryGetValue(210, out data) && ActionManager.CanCast(data, Core.Me)) ActionManager.DoAction(210, Core.Me);
    	]]>
		</CodeChunk>
		<CodeChunk Name="GoSwimming">
			<![CDATA[
				var esc = new Vector3(-251.1348f, -73.0573f, -268.9804f);
				await Buddy.Coroutines.Coroutine.Sleep(1000);
				Navigator.PlayerMover.MoveTowards(esc);
				await Buddy.Coroutines.Coroutine.Sleep(10000);
				Navigator.PlayerMover.MoveStop();	
		]]>
		</CodeChunk>
		<CodeChunk Name="AutoEquip">
            <![CDATA[ 
				var patternFinder = new GreyMagic.PatternFinder(Core.Memory);
				IntPtr agentVtable = patternFinder.Find("48 8D 05 ? ? ? ? C6 43 ? ? 48 89 03 48 8B C3 C7 43 ? ? ? ? ? Add 3 TraceRelative");
				int id = AgentModule.FindAgentIdByVtable(agentVtable);

				AtkAddonControl windowByName = RaptureAtkUnitManager.GetWindowByName("RecommendEquip");

				if (windowByName == null)
				{
					AgentModule.GetAgentInterfaceById(id).Toggle();
				}

				await Coroutine.Wait(10000, () => RaptureAtkUnitManager.GetWindowByName("RecommendEquip") != null);
            
				windowByName = RaptureAtkUnitManager.GetWindowByName("RecommendEquip");
            
				if (windowByName != null)
				{
					windowByName.SendAction(1, 3, 0);
				}
        ]]>
        </CodeChunk>
		<CodeChunk Name="UpdateGearSet">
			<![CDATA[ 
				var patternFinder = new GreyMagic.PatternFinder(Core.Memory);
				IntPtr agentCharVtable = patternFinder.Find("48 8D 05 ? ? ? ? 89 77 ? Add 3 TraceRelative");
				int idChar = AgentModule.FindAgentIdByVtable(agentCharVtable);

				AtkAddonControl windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

				if (windowByName == null)
				{
					AgentModule.GetAgentInterfaceById(idChar).Toggle();
				}

				await Coroutine.Wait(5000, () => RaptureAtkUnitManager.GetWindowByName("Character") != null);

				windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

				if (windowByName != null)
				{
					windowByName.SendAction(1, 3, 0xF);
				}
            
				await Coroutine.Wait(1000, () => SelectYesno.IsOpen);

				if (SelectYesno.IsOpen)
					SelectYesno.Yes();

				await Coroutine.Wait(1000, () => !SelectYesno.IsOpen);
			
				await Coroutine.Sleep(200);
			
				windowByName = RaptureAtkUnitManager.GetWindowByName("Character");

				if (windowByName != null)
				{
					AgentModule.GetAgentInterfaceById(idChar).Toggle();
				}			
		]]>
		</CodeChunk>
		<CodeChunk Name="SetGearSet">
		<![CDATA[ 
			await Coroutine.Sleep(2000);
		   
			ff14bot.Managers.ChatManager.SendChat("/gs save");
			
			await Coroutine.Sleep(2000);
			
			]]>
		</CodeChunk>
	</CodeChunks>
</Profile>
